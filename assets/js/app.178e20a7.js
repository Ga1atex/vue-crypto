(function(){"use strict";var e={3302:function(e,t,n){var r=n(9242),i=n(3396),s=n(7139);const o={class:"container mx-auto flex flex-col items-center bg-gray-100 p-4"},a={key:0,class:"fixed w-100 h-100 opacity-80 bg-purple-800 inset-0 z-50 flex items-center justify-center"},l=(0,i._)("svg",{class:"animate-spin -ml-1 mr-3 h-12 w-12 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[(0,i._)("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),(0,i._)("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),c=[l],d={class:"container"},u=(0,i._)("hr",{class:"w-full border-t border-gray-600 my-4"},null,-1),p={class:""},h=(0,i._)("span",null,"Фильтр:",-1),g=(0,i.Uk)(),m={key:0,class:""},f=(0,i.Uk)(" Назад "),w=(0,i.Uk)(" Вперед "),b=(0,i._)("hr",{class:"w-full border-t border-gray-600 my-4"},null,-1),v={class:"mt-5 grid grid-cols-1 gap-5 sm:grid-cols-3"},y=["onClick"],C={class:"px-4 py-5 sm:p-6 text-center"},x={class:"text-sm font-medium text-gray-500 truncate"},S={class:"mt-1 text-3xl font-semibold text-gray-900"},k=(0,i._)("div",{class:"w-full border-t border-gray-200"},null,-1),E=["onClick"],_=(0,i._)("svg",{class:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"#718096","aria-hidden":"true"},[(0,i._)("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1),O=(0,i.Uk)(" Удалить "),D=[_,O],I=(0,i._)("hr",{class:"w-full border-t border-gray-600 my-4"},null,-1);function z(e,t,n,l,_,O){const z=(0,i.up)("add-coin"),A=(0,i.up)("rounded-button"),U=(0,i.up)("price-graph");return(0,i.wg)(),(0,i.iD)("div",o,[_.isAppInitialized?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",a,c)),(0,i._)("div",d,[(0,i.Wm)(z,{onAddCoin:O.addAndUpdate,allCoinData:_.allCoinData,coins:_.coins},null,8,["onAddCoin","allCoinData","coins"]),_.coins.length?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[(0,i._)("div",null,[u,(0,i._)("div",p,[h,g,(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>_.filter=e)},null,512),[[r.nr,_.filter]])]),O.filteredList.length>6?((0,i.wg)(),(0,i.iD)("div",m,[(0,i.Wm)(A,{onClick:t[1]||(t[1]=e=>_.page=+_.page-1),disabled:!(_.page>1),class:"mx-2"},{default:(0,i.w5)((()=>[f])),_:1},8,["disabled"]),(0,i.Wm)(A,{disabled:!(_.page<Math.ceil(_.coins.length/_.pagePortionSize)),onClick:t[2]||(t[2]=e=>_.page=+_.page+1)},{default:(0,i.w5)((()=>[w])),_:1},8,["disabled"])])):(0,i.kq)("",!0)]),b,(0,i._)("dl",v,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(O.paginatedList,(e=>((0,i.wg)(),(0,i.iD)("div",{key:e.name,onClick:t=>!e.error&&O.select(e),class:(0,s.C_)([[{"border-4":_.selectedCoin===e},e.error?"bg-red-100":"bg-white cursor-pointer"],"overflow-hidden shadow rounded-lg border-purple-800 border-solid"])},[(0,i._)("div",C,[(0,i._)("dt",x,(0,s.zw)(e.name)+" - USD ",1),(0,i._)("dd",S,(0,s.zw)(O.formatPrice(e.price)),1)]),k,(0,i._)("button",{onClick:(0,r.iM)((t=>O.handleDelete(e)),["stop"]),class:"flex items-center justify-center font-medium w-full bg-gray-100 px-4 py-4 sm:px-6 text-md text-gray-500 hover:text-gray-600 hover:bg-gray-200 hover:opacity-20 transition-all focus:outline-none"},D,8,E)],10,y)))),128))]),I],64)):(0,i.kq)("",!0),_.selectedCoin?((0,i.wg)(),(0,i.j4)(U,{key:1,onCloseGraph:t[3]||(t[3]=e=>_.selectedCoin=null),onUpdateGraphBarAmount:O.updateGraphBarAmount,selectedCoin:_.selectedCoin,graph:_.graph},null,8,["onUpdateGraphBarAmount","selectedCoin","graph"])):(0,i.kq)("",!0)])])}n(6699);var A=n(3029);const U="5",G="500",L="INVALID_SUB",j="USD",P=new Map,M=async()=>{const e=await fetch("https://min-api.cryptocompare.com/data/all/coinlist?summary=true"),t=await e.json();return t},N=(0,A.Z)(),B=new SharedWorker(new URL(n.p+n.u(356),n.b));let R;function W(e){const{TYPE:t,FROMSYMBOL:n,PRICE:r,MESSAGE:i,PARAMETER:s}=e.data;if(t===G&&i===L){const e=s.split("~")[2],t=P.get(e)??{},n=t?.fail;return void(Array.isArray(n)?n.forEach((e=>e(i))):n(i))}if(t!==U||void 0===r)return;const o=P.get(n)??{},a=o?.success;Array.isArray(a)?a.forEach((e=>e(r))):a(r)}B.port.start(),B.port.addEventListener("message",(e=>{switch(e.data.type){case"WSState":R=e.data.state;break;case"message":W(e.data);break}}),!1);const $=(e,t,n)=>({action:e,subs:[`5~CCCAGG~${t}~${n}`]}),q=(e,t=j)=>{const n=$("SubAdd",e,t);H(n)},V=(e,t=j)=>{const n=$("SubRemove",e,t);H(n)},F=(e,t)=>{const n=P.get(e);n?(Object.entries(t).forEach((e=>{const[t,r]=e,i=n[t]||[];Array.isArray(i)?n[t]=[...i,r]:n[t]=[i,r]})),P.set(e,n)):(q(e),P.set(e,t))},T=e=>{V(e),P.delete(e)};function H(e){R===WebSocket.CONNECTING?console.log("Still connecting to the server, try again later!"):R===WebSocket.CLOSING||R===WebSocket.CLOSED?console.log("Connection Closed!"):B.port.postMessage({from:N,data:e})}const Z={class:"flex"},Y={class:"max-w-xs"},J=(0,i._)("label",{for:"wallet",class:"block text-sm font-medium text-gray-700"},"Тикер",-1),K={class:"mt-1 relative rounded-md shadow-md"},Q={class:"flex bg-white shadow-md p-1 rounded-md shadow-md flex-wrap"},X=["onClick"],ee={key:0,class:"text-sm text-red-600"},te=(0,i.Uk)(" Добавить ");function ne(e,t,n,o,a,l){const c=(0,i.up)("plus-sign-icon"),d=(0,i.up)("rounded-button");return(0,i.wg)(),(0,i.iD)("section",null,[(0,i._)("div",Z,[(0,i._)("div",Y,[J,(0,i._)("div",K,[(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.coinNameInput=e),onInput:t[1]||(t[1]=(...e)=>l.coinOnChange&&l.coinOnChange(...e)),onKeydown:t[2]||(t[2]=(0,r.D2)(((...e)=>l.add&&l.add(...e)),["enter"])),type:"text",name:"wallet",id:"wallet",class:"block w-full pr-10 border-gray-300 text-gray-900 focus:outline-none focus:ring-gray-500 focus:border-gray-500 sm:text-sm rounded-md",placeholder:"Например DOGE"},null,544),[[r.nr,a.coinNameInput]])]),(0,i.wy)((0,i._)("div",Q,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.coinSuggestions,(e=>((0,i.wg)(),(0,i.iD)("span",{onClick:t=>{a.coinNameInput=e,l.add()},key:e,class:"inline-flex items-center px-2 m-1 rounded-md text-xs font-medium bg-gray-300 text-gray-800 cursor-pointer"},(0,s.zw)(e),9,X)))),128))],512),[[r.F8,a.coinSuggestions.length]]),a.coinInputError?((0,i.wg)(),(0,i.iD)("div",ee,(0,s.zw)(a.coinInputError),1)):(0,i.kq)("",!0)])]),(0,i.Wm)(d,{onClick:l.add,type:"button"},{default:(0,i.w5)((()=>[(0,i.Wm)(c),te])),_:1},8,["onClick"])])}const re=["disabled"];function ie(e,t,n,r,o,a){return(0,i.wg)(),(0,i.iD)("button",{class:(0,s.C_)(["my-4 inline-flex items-center py-2 px-4 border border-transparent shadow-sm text-sm leading-4 font-medium rounded-full text-white bg-gray-600 hover:bg-gray-700 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",{"opacity-50":n.disabled}]),disabled:n.disabled},[(0,i.WI)(e.$slots,"default")],10,re)}var se={props:{disabled:{type:Boolean,required:!1,default:!1}}},oe=n(89);const ae=(0,oe.Z)(se,[["render",ie]]);var le=ae;const ce={class:"-ml-0.5 mr-2 h-6 w-6",xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",viewBox:"0 0 24 24",fill:"#ffffff"},de=(0,i._)("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"},null,-1),ue=[de];function pe(e,t,n,r,s,o){return(0,i.wg)(),(0,i.iD)("svg",ce,ue)}var he={};const ge=(0,oe.Z)(he,[["render",pe]]);var me=ge,fe={components:{RoundedButton:le,PlusSignIcon:me},data(){return{coinNameInput:"",coinInputError:"",coinSuggestions:[]}},props:{allCoinData:{type:Object,required:!0},coins:{type:Array,required:!1,default:()=>[]}},emits:{"add-coin":e=>"string"===typeof e},methods:{coinOnChange(){this.coinInputError="",this.coinSuggestions=[];const e=this.coinNameInput.toUpperCase();if(e)for(const t of Object.values(this.allCoinData)){if(this.coinSuggestions.length>3)break;(t.Symbol.toUpperCase().includes(e)||t.FullName.toUpperCase().includes(e))&&this.coinSuggestions.push(t.Symbol.toUpperCase())}},add(){if(!this.coinNameInput)return void(this.coinInputError="Введите значение");const e=this.coinNameInput.toUpperCase();this.coins.some((t=>e===t.name))?this.coinInputError="Такой тикер уже добавлен":(this.$emit("add-coin",e),this.coinSuggestions=[],this.coinNameInput="")}}};const we=(0,oe.Z)(fe,[["render",ne]]);var be=we;const ve={class:"relative"},ye={class:"text-lg leading-6 font-medium text-gray-900 my-8"},Ce={class:"flex items-end border-gray-600 border-b border-l h-64",ref:"graph"};function xe(e,t,n,r,o,a){const l=(0,i.up)("cross-sign");return(0,i.wg)(),(0,i.iD)("section",ve,[(0,i._)("h3",ye,(0,s.zw)(n.selectedCoin.name)+" - USD ",1),(0,i._)("div",Ce,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.normalizeGraph,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{key:t,style:(0,s.j5)({height:`${e}%`}),class:"bg-purple-800 border w-10",ref_for:!0,ref:"graphbar"},null,4)))),128))],512),(0,i._)("button",{onClick:t[0]||(t[0]=(...e)=>a.closeGraph&&a.closeGraph(...e)),type:"button",class:"absolute top-0 right-0"},[(0,i.Wm)(l)])])}const Se={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:svgjs":"http://svgjs.com/svgjs",version:"1.1",width:"30",height:"30",x:"0",y:"0",viewBox:"0 0 511.76 511.76",style:{"enable-background":"new 0 0 512 512"},"xml:space":"preserve"},ke=(0,i._)("g",null,[(0,i._)("path",{d:"M436.896,74.869c-99.84-99.819-262.208-99.819-362.048,0c-99.797,99.819-99.797,262.229,0,362.048    c49.92,49.899,115.477,74.837,181.035,74.837s131.093-24.939,181.013-74.837C536.715,337.099,536.715,174.688,436.896,74.869z     M361.461,331.317c8.341,8.341,8.341,21.824,0,30.165c-4.16,4.16-9.621,6.251-15.083,6.251c-5.461,0-10.923-2.091-15.083-6.251    l-75.413-75.435l-75.392,75.413c-4.181,4.16-9.643,6.251-15.083,6.251c-5.461,0-10.923-2.091-15.083-6.251    c-8.341-8.341-8.341-21.845,0-30.165l75.392-75.413l-75.413-75.413c-8.341-8.341-8.341-21.845,0-30.165    c8.32-8.341,21.824-8.341,30.165,0l75.413,75.413l75.413-75.413c8.341-8.341,21.824-8.341,30.165,0    c8.341,8.32,8.341,21.824,0,30.165l-75.413,75.413L361.461,331.317z",fill:"#718096","data-original":"#000000"})],-1),Ee=[ke];function _e(e,t,n,r,s,o){return(0,i.wg)(),(0,i.iD)("svg",Se,Ee)}var Oe={};const De=(0,oe.Z)(Oe,[["render",_e]]);var Ie=De,ze={components:{CrossSign:Ie},props:{selectedCoin:{type:[null,Object],required:!0},graph:{type:Array,required:!0}},emits:{"close-graph":null,"update-graph-bar-amount":null},data(){return{maxGraphElements:1,resizeObserver:null}},methods:{closeGraph(){this.$emit("close-graph")},calculateMaxGraphElements(){this.$refs.graph&&(this.maxGraphElements=Math.floor(this.$refs.graph?.clientWidth/(this.$refs.graphbar?.offsetWidth||40)))},createResizeObserver(){this.resizeObserver=new ResizeObserver(this.updateGraphBarAmount)},updateGraphBarAmount(){this.calculateMaxGraphElements(),this.$emit("update-graph-bar-amount",this.maxGraphElements)}},computed:{normalizeGraph(){const e=Math.max(...this.graph),t=Math.min(...this.graph);return e===t?this.graph.map((()=>50)):this.graph.map((n=>5+95*(n-t)/(e-t)))}},mounted(){this.createResizeObserver(),this.resizeObserver.observe(this.$refs.graph)},beforeUnmount(){this.resizeObserver.disconnect()},watch:{graph(){this.updateGraphBarAmount()}}};const Ae=(0,oe.Z)(ze,[["render",xe]]);var Ue=Ae,Ge={name:"App",components:{AddCoin:be,RoundedButton:le,PriceGraph:Ue},data(){return{coinInputError:"",coins:[],coinSuggestions:[],selectedCoin:null,graph:[],allCoinData:{},isAppInitialized:!1,filter:"",page:1,pagePortionSize:6}},created(){this.syncFromUrl(),this.syncFromLocalStorage()},computed:{pageStateOptions(){return{filter:this.filter,page:this.page}},startPageIndex(){return(this.page-1)*this.pagePortionSize},endPageIndex(){return this.page*this.pagePortionSize},filteredList(){return this.coins.filter((e=>e.name.includes(this.filter.toUpperCase())))},paginatedList(){return this.filteredList.slice(this.startPageIndex,this.endPageIndex)}},methods:{syncFromLocalStorage(){const e=localStorage.getItem("crypto-list");e?.length&&(this.coins=JSON.parse(e),this.coins.forEach((e=>{this.subscribeToCoinEvents(e.name)})))},handleStorageEvent(e){if("crypto-list"!=e.key)return;const{newValue:t,oldValue:n}=e;this.coins=JSON.parse(t);const r=JSON.parse(t),i=JSON.parse(n);if(r.length>i.length){const e=r.slice(i.length);e.forEach((e=>{this.subscribeToCoinEvents(e.name)}))}},syncFromUrl(){const e=Object.fromEntries(new URL(window.location).searchParams.entries()),t=["filter","page"];t.forEach((t=>{e[t]&&(this[t]=e[t])}))},updateGraphBarAmount(e){this.graph.length>e&&(this.graph=this.graph.slice(this.graph.length-e))},updateCoinPrice(e,t){const n=this.coins.find((t=>t.name===e));n===this.selectedCoin&&(this.graph=[...this.graph,t]),n.price=t},setCoinError(e,t){const n=this.coins.find((t=>t.name===e));n.error=t},addAndUpdate(e){const t={name:e,price:null};this.coins=[...this.coins,t],this.filter="",this.subscribeToCoinEvents(t.name)},formatPrice(e){return null===e?"-":("string"===typeof e&&(e=Number(e)),e>1?e.toFixed(2):e.toPrecision(2))},updateCoinsInLocalStorage(){localStorage.setItem("crypto-list",JSON.stringify(this.coins))},handleDelete(e){this.coins=this.coins.filter((t=>t!==e)),this.selectedCoin===e&&(this.selectedCoin=null),T(e.name)},select(e){this.selectedCoin=e},async getCoinsData(){try{const e=await M();this.allCoinData=e.Data}catch(e){console.log(e)}finally{this.isAppInitialized=!0}},subscribeToCoinEvents(e){F(e,{success:t=>this.updateCoinPrice(e,t),fail:t=>this.setCoinError(e,t)})}},mounted(){this.getCoinsData(),window.addEventListener("storage",this.handleStorageEvent)},beforeUnmount(){window.removeEventListener("storage",this.handleStorageEvent)},watch:{selectedCoin(){this.graph=[this.selectedCoin?.price]},paginatedList(){0===this.paginatedList.length&&this.page>1&&(this.page-=1)},coins(){this.updateCoinsInLocalStorage()},filter(){this.page=1},pageStateOptions(e){const t=new URLSearchParams;Object.entries(e).forEach((([e,n])=>{n&&t.append(e,n)})),window.history.pushState(null,document.title,`${window.location.pathname}?${t}`)}}};const Le=(0,oe.Z)(Ge,[["render",z]]);var je=Le;const Pe=(0,r.ri)(je);Pe.mount("#app")}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.m=e,function(){var e=[];n.O=function(t,r,i,s){if(!r){var o=1/0;for(d=0;d<e.length;d++){r=e[d][0],i=e[d][1],s=e[d][2];for(var a=!0,l=0;l<r.length;l++)(!1&s||o>=s)&&Object.keys(n.O).every((function(e){return n.O[e](r[l])}))?r.splice(l--,1):(a=!1,s<o&&(o=s));if(a){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[r,i,s]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.u=function(e){return"assets/js/"+e+".d832ec1a.js"}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.p="/vue-crypto/"}(),function(){n.b=document.baseURI||self.location.href;var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var i,s,o=r[0],a=r[1],l=r[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(l)var d=l(n)}for(t&&t(r);c<o.length;c++)s=o[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(d)},r=self["webpackChunkvue_crypto"]=self["webpackChunkvue_crypto"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=n.O(void 0,[998],(function(){return n(3302)}));r=n.O(r)})();